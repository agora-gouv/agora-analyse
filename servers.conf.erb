server {
    server_name localhost;
    listen <%= ENV['PORT'] %>;

    <% if ENV['NGINX_PASSWORD'] %>
    auth_basic "Protected Site User: <%= ENV['NGINX_USER'] %>";
    auth_basic_user_file "/app/config/htpasswd";
    <% end %>

    location / {
        proxy_pass http://localhost:<%= ENV['AGORA_PORT'] %>;
        proxy_set_header  X-Remote-Address $remote_addr;
        proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_redirect default;
    }
                              
    charset utf-8;
    autoindex off;
    root /app/public_html;
}